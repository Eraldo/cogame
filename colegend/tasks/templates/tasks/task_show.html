{% extends 'page.html' %}
{% load icons %}

{% block page_title %}
    {{ task }}
{% endblock %}

{% block up_url %}{% url "tasks:task_list" %}{% endblock %}

{% block page_title_extras %}
{% endblock %}

{% block page_controls %}
    <a href="{{ task.get_edit_url }}" class="btn btn-primary" role="button">{% icon "edit" %}</a>
    <a href="{{ task.get_delete_url }}" class="btn btn-danger" role="button">{% icon "delete" %}</a>
{% endblock %}

{% block page_content %}
    <div class="task-details well">
        {% if task.open %}
            <form method="POST" action="{% url "tasks:task_complete" task.pk %}" role="form"
                  class="inline">{% csrf_token %}
                <button class="btn btn-xs btn-default" role="submit">{% icon "task" %}</button>
            </form>
        {% elif task.closed %}
            <form method="GET" action="{% url "tasks:task_show" task.pk %}" role="form"
                  class="inline">{% csrf_token %}
                <button class="btn btn-xs btn-success" role="submit">{% icon "task" %}</button>
            </form>
        {% endif %}
        {% include "status/_status_field.html" with status=task.status %}
        {% include "lib/_priority_field.html" with priority=task.priority %}
        {% include "tags/_tags_field.html" with tags=task.tags.all %}
        <div class="task-context pull-right">
            {% include "projects/_project_field.html" with project=task.project %}
            {% include "lib/_date_field.html" with date=task.date %}
            {% include "lib/_deadline_field.html" with deadline=task.deadline %}
        </div>
        {{ task.description }}
    </div>
{% endblock %}
